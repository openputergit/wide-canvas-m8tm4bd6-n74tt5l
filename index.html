<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Management System</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .loading {
            position: relative;
        }
        .loading:after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cpath d='M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634 c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z' fill='%233B82F6' /%3E%3Cpath d='M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z' fill='%233B82F6'%3E%3CanimateTransform attributeType='xml' attributeName='transform' type='rotate' from='0 20 20' to='360 20 20' dur='0.8s' repeatCount='indefinite'/%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
        }
        .modal {
            transition: opacity 0.25s ease;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="min-h-screen">
        <!-- Sidebar -->
        <aside class="fixed h-screen w-64 bg-white shadow-lg overflow-y-auto z-10">
            <div class="p-4">
                <h1 class="text-2xl font-bold text-gray-800">Store Manager</h1>
            </div>
            <nav class="mt-4">
                <a href="#" class="block px-4 py-2 text-gray-600 hover:bg-blue-50 hover:text-blue-600" id="nav-dashboard">
                    <i class="bi bi-grid-1x2-fill mr-2"></i>Dashboard
                </a>
                <a href="#" class="block px-4 py-2 text-gray-600 hover:bg-blue-50 hover:text-blue-600" id="nav-inventory">
                    <i class="bi bi-box-seam mr-2"></i>Inventory
                </a>
                <a href="#" class="block px-4 py-2 text-gray-600 hover:bg-blue-50 hover:text-blue-600" id="nav-transactions">
                    <i class="bi bi-arrow-left-right mr-2"></i>Transactions
                </a>
                <a href="#" class="block px-4 py-2 text-gray-600 hover:bg-blue-50 hover:text-blue-600" id="nav-reports">
                    <i class="bi bi-graph-up mr-2"></i>Reports
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="ml-64 p-8">
            <!-- Dashboard Section -->
            <section id="dashboard" class="space-y-6">
                <h1 class="text-2xl font-bold text-gray-800 mb-6">Dashboard Overview</h1>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold text-gray-700">Total Revenue</h3>
                        <p class="text-3xl font-bold text-green-600">$24,500</p>
                        <span class="text-sm text-gray-500">+12% from last month</span>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold text-gray-700">Total Expenses</h3>
                        <p class="text-3xl font-bold text-red-600">$18,300</p>
                        <span class="text-sm text-gray-500">-3% from last month</span>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold text-gray-700">Net Profit</h3>
                        <p class="text-3xl font-bold text-blue-600">$6,200</p>
                        <span class="text-sm text-gray-500">+15% from last month</span>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Monthly Profit Trend</h3>
                    <canvas id="profitChart"></canvas>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Low Stock Items</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="px-4 py-2">SKU</th>
                                        <th class="px-4 py-2">Item Name</th>
                                        <th class="px-4 py-2">Quantity</th>
                                    </tr>
                                </thead>
                                <tbody id="lowStockTable">
                                    <!-- Will be populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Top Selling Items</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="px-4 py-2">SKU</th>
                                        <th class="px-4 py-2">Item Name</th>
                                        <th class="px-4 py-2">Units Sold</th>
                                    </tr>
                                </thead>
                                <tbody id="topSellingTable">
                                    <!-- Will be populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Inventory Section -->
            <section id="inventory" class="hidden space-y-6">
                <div class="flex justify-between items-center mb-6">
                    <h1 class="text-2xl font-bold text-gray-800">Inventory Management</h1>
                    <div class="flex space-x-2">
                        <div class="relative">
                            <input type="text" id="inventorySearch" placeholder="Search by SKU or name" class="border border-gray-300 px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-64">
                            <i class="bi bi-search absolute right-3 top-3 text-gray-400"></i>
                        </div>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center" id="addItemBtn">
                            <i class="bi bi-plus mr-2"></i> Add New Item
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead>
                                <tr class="bg-gray-50 border-b">
                                    <th class="px-6 py-3">SKU</th>
                                    <th class="px-6 py-3">Item Name</th>
                                    <th class="px-6 py-3">Quantity</th>
                                    <th class="px-6 py-3">Buy Price</th>
                                    <th class="px-6 py-3">Sell Price</th>
                                    <th class="px-6 py-3">Status</th>
                                    <th class="px-6 py-3">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTable">
                                <!-- Data will be populated via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Transactions Section -->
            <section id="transactions" class="hidden space-y-6">
                <div class="flex justify-between items-center mb-6">
                    <h1 class="text-2xl font-bold text-gray-800">Transactions</h1>
                    <div class="flex space-x-2">
                        <button class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center" id="newPurchaseBtn">
                            <i class="bi bi-bag-plus mr-2"></i> New Purchase
                        </button>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center" id="newSaleBtn">
                            <i class="bi bi-cart-plus mr-2"></i> New Sale
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex space-x-4 mb-6">
                        <button class="px-4 py-2 bg-blue-600 text-white rounded-lg transaction-filter active" data-type="all">All Transactions</button>
                        <button class="px-4 py-2 bg-gray-200 rounded-lg transaction-filter" data-type="purchase">Purchases</button>
                        <button class="px-4 py-2 bg-gray-200 rounded-lg transaction-filter" data-type="sale">Sales</button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead>
                                <tr class="bg-gray-50 border-b">
                                    <th class="px-6 py-3">ID</th>
                                    <th class="px-6 py-3">Date</th>
                                    <th class="px-6 py-3">Type</th>
                                    <th class="px-6 py-3">SKU</th>
                                    <th class="px-6 py-3">Item</th>
                                    <th class="px-6 py-3">Quantity</th>
                                    <th class="px-6 py-3">Rate</th>
                                    <th class="px-6 py-3">Total</th>
                                </tr>
                            </thead>
                            <tbody id="transactionsTable">
                                <!-- Data will be populated via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports" class="hidden space-y-6">
                <h1 class="text-2xl font-bold text-gray-800 mb-6">Profit & Loss Reports</h1>
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold">Revenue & Profit Analysis</h2>
                        <div class="flex space-x-2">
                            <button class="px-4 py-2 bg-blue-600 text-white rounded-lg active report-period" data-period="daily">Daily</button>
                            <button class="px-4 py-2 bg-gray-200 rounded-lg report-period" data-period="weekly">Weekly</button>
                            <button class="px-4 py-2 bg-gray-200 rounded-lg report-period" data-period="monthly">Monthly</button>
                        </div>
                    </div>
                    <canvas id="reportsChart" height="100"></canvas>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-xl font-semibold mb-4">SKU Performance</h2>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="px-4 py-2">SKU</th>
                                        <th class="px-4 py-2">Item Name</th>
                                        <th class="px-4 py-2">In Stock</th>
                                        <th class="px-4 py-2">Sold QTY</th>
                                        <th class="px-4 py-2">Profit</th>
                                    </tr>
                                </thead>
                                <tbody id="skuPerformanceTable">
                                    <!-- Will be populated -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-xl font-semibold mb-4">Profit Distribution</h2>
                        <canvas id="profitDistributionChart"></canvas>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Add Item Modal -->
    <div id="addItemModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 hidden modal">
        <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold">Add New Item</h2>
                <button class="text-gray-500 hover:text-gray-700" id="closeAddItemModal">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <form id="addItemForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 mb-1" for="itemSku">SKU</label>
                    <input type="text" id="itemSku" class="w-full px-4 py-2 border rounded-lg" placeholder="Enter SKU" required>
                </div>
                <div>
                    <label class="block text-gray-700 mb-1" for="itemName">Item Name</label>
                    <input type="text" id="itemName" class="w-full px-4 py-2 border rounded-lg" placeholder="Enter item name" required>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 mb-1" for="itemQuantity">Initial Quantity</label>
                        <input type="number" id="itemQuantity" class="w-full px-4 py-2 border rounded-lg" placeholder="0" min="0" required>
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-1" for="itemBuyPrice">Buy Price</label>
                        <input type="number" id="itemBuyPrice" class="w-full px-4 py-2 border rounded-lg" placeholder="0.00" min="0" step="0.01" required>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 mb-1" for="itemSellPrice">Sell Price</label>
                        <input type="number" id="itemSellPrice" class="w-full px-4 py-2 border rounded-lg" placeholder="0.00" min="0" step="0.01" required>
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-1" for="itemStatus">Status</label>
                        <select id="itemStatus" class="w-full px-4 py-2 border rounded-lg" required>
                            <option value="In Stock">In Stock</option>
                            <option value="Low Stock">Low Stock</option>
                            <option value="Out of Stock">Out of Stock</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end pt-2">
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Add Item</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Transaction Modal (Purchase/Sale) -->
    <div id="transactionModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 hidden modal">
        <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold" id="transactionModalTitle">New Transaction</h2>
                <button class="text-gray-500 hover:text-gray-700" id="closeTransactionModal">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <form id="transactionForm" class="space-y-4">
                <input type="hidden" id="transactionType" value="">
                <div>
                    <label class="block text-gray-700 mb-1" for="transactionSku">SKU</label>
                    <select id="transactionSku" class="w-full px-4 py-2 border rounded-lg" required>
                        <option value="">Select Item</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                <div id="itemDetailsContainer" class="bg-gray-50 p-3 rounded-lg hidden">
                    <div class="text-sm" id="itemDetails">
                        <!-- Item details will be shown here dynamically -->
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 mb-1" for="transactionDate">Date</label>
                        <input type="date" id="transactionDate" class="w-full px-4 py-2 border rounded-lg" required>
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-1" for="transactionQty">Quantity</label>
                        <input type="number" id="transactionQty" class="w-full px-4 py-2 border rounded-lg" placeholder="0" min="1" required>
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 mb-1" for="transactionRate">Rate (per unit)</label>
                    <input type="number" id="transactionRate" class="w-full px-4 py-2 border rounded-lg" placeholder="0.00" min="0" step="0.01" required>
                </div>
                <div>
                    <div class="flex justify-between">
                        <span class="text-gray-700">Total:</span>
                        <span class="font-semibold" id="transactionTotal">$0.00</span>
                    </div>
                </div>
                <div class="flex justify-end pt-2">
                    <button type="submit" class="px-6 py-2 rounded-lg" id="transactionSubmitBtn">Add Transaction</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Sample data
        let inventory = [
            { sku: "SKU001", name: "Laptop", quantity: 15, buyPrice: 450, sellPrice: 599, status: "In Stock" },
            { sku: "SKU002", name: "Smartphone", quantity: 25, buyPrice: 300, sellPrice: 399, status: "In Stock" },
            { sku: "SKU003", name: "Headphones", quantity: 5, buyPrice: 20, sellPrice: 49.99, status: "Low Stock" },
            { sku: "SKU004", name: "Monitor", quantity: 10, buyPrice: 150, sellPrice: 249, status: "In Stock" },
            { sku: "SKU005", name: "Keyboard", quantity: 3, buyPrice: 25, sellPrice: 39.99, status: "Low Stock" }
        ];

        let transactions = [
            { id: 1, date: "2023-07-01", type: "purchase", sku: "SKU001", item: "Laptop", quantity: 5, rate: 450, total: 2250 },
            { id: 2, date: "2023-07-05", type: "sale", sku: "SKU001", item: "Laptop", quantity: 2, rate: 599, total: 1198 },
            { id: 3, date: "2023-07-12", type: "purchase", sku: "SKU002", item: "Smartphone", quantity: 10, rate: 300, total: 3000 },
            { id: 4, date: "2023-07-15", type: "sale", sku: "SKU002", item: "Smartphone", quantity: 4, rate: 399, total: 1596 },
            { id: 5, date: "2023-07-20", type: "purchase", sku: "SKU003", item: "Headphones", quantity: 15, rate: 20, total: 300 },
            { id: 6, date: "2023-07-22", type: "sale", sku: "SKU003", item: "Headphones", quantity: 8, rate: 49.99, total: 399.92 }
        ];

        // Chart data
        const dailyData = {
            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
            revenues: [1200, 1400, 1100, 1600, 1300, 1700, 1500],
            expenses: [900, 1100, 850, 1200, 950, 1300, 1100],
            profits: [300, 300, 250, 400, 350, 400, 400]
        };

        const weeklyData = {
            labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
            revenues: [6500, 5900, 6700, 7200],
            expenses: [4800, 4400, 5100, 5500],
            profits: [1700, 1500, 1600, 1700]
        };

        const monthlyData = {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            revenues: [25000, 27000, 23000, 28000, 26000, 29000],
            expenses: [18000, 20000, 17000, 21000, 19500, 22000],
            profits: [7000, 7000, 6000, 7000, 6500, 7000]
        };

        // DOM Elements
        const navLinks = {
            dashboard: document.getElementById('nav-dashboard'),
            inventory: document.getElementById('nav-inventory'),
            transactions: document.getElementById('nav-transactions'),
            reports: document.getElementById('nav-reports')
        };

        const sections = {
            dashboard: document.getElementById('dashboard'),
            inventory: document.getElementById('inventory'),
            transactions: document.getElementById('transactions'),
            reports: document.getElementById('reports')
        };

        // Navigation
        function showSection(sectionId) {
            // Hide all sections
            Object.values(sections).forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            sections[sectionId].classList.remove('hidden');
            
            // Update active nav link
            Object.entries(navLinks).forEach(([id, link]) => {
                if (id === sectionId) {
                    link.classList.add('bg-blue-50', 'text-blue-600');
                } else {
                    link.classList.remove('bg-blue-50', 'text-blue-600');
                }
            });
        }

        // Add event listeners to navigation links
        Object.entries(navLinks).forEach(([id, link]) => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                showSection(id);
            });
        });

        // Initialize Charts
        const profitCtx = document.getElementById('profitChart').getContext('2d');
        const reportsCtx = document.getElementById('reportsChart').getContext('2d');
        const profitDistributionCtx = document.getElementById('profitDistributionChart').getContext('2d');

        const profitChart = new Chart(profitCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'Monthly Profit',
                    data: [5000, 6200, 7400, 6800, 6200, 8400],
                    borderColor: 'rgb(59, 130, 246)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    tension: 0.3,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            display: true,
                            drawBorder: false
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        const reportsChart = new Chart(reportsCtx, {
            type: 'bar',
            data: {
                labels: dailyData.labels,
                datasets: [
                    {
                        label: 'Revenue',
                        data: dailyData.revenues,
                        backgroundColor: 'rgba(59, 130, 246, 0.6)'
                    },
                    {
                        label: 'Expenses',
                        data: dailyData.expenses,
                        backgroundColor: 'rgba(239, 68, 68, 0.6)'
                    },
                    {
                        label: 'Profit',
                        data: dailyData.profits,
                        backgroundColor: 'rgba(16, 185, 129, 0.6)'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        const profitDistributionChart = new Chart(profitDistributionCtx, {
            type: 'doughnut',
            data: {
                labels: ['Laptops', 'Smartphones', 'Headphones', 'Monitors', 'Other'],
                datasets: [{
                    data: [35, 25, 15, 15, 10],
                    backgroundColor: [
                        'rgba(59, 130, 246, 0.7)',
                        'rgba(16, 185, 129, 0.7)',
                        'rgba(245, 158, 11, 0.7)',
                        'rgba(139, 92, 246, 0.7)',
                        'rgba(107, 114, 128, 0.7)'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right'
                    }
                }
            }
        });

        // Update Reports Chart
        function updateReportsChart(period) {
            let data;
            switch(period) {
                case 'daily':
                    data = dailyData;
                    break;
                case 'weekly':
                    data = weeklyData;
                    break;
                case 'monthly':
                    data = monthlyData;
                    break;
                default:
                    data = dailyData;
            }
            
            reportsChart.data.labels = data.labels;
            reportsChart.data.datasets[0].data = data.revenues;
            reportsChart.data.datasets[1].data = data.expenses;
            reportsChart.data.datasets[2].data = data.profits;
            reportsChart.update();
        }

        // Add event listeners to report period buttons
        document.querySelectorAll('.report-period').forEach(button => {
            button.addEventListener('click', () => {
                // Update active button
                document.querySelectorAll('.report-period').forEach(btn => {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                });
                button.classList.remove('bg-gray-200', 'text-gray-700');
                button.classList.add('bg-blue-600', 'text-white');
                
                // Update chart
                updateReportsChart(button.dataset.period);
            });
        });

        // Inventory Management Functions
        function updateInventoryTable() {
            const table = document.getElementById('inventoryTable');
            table.innerHTML = inventory.map(item => `
                <tr class="border-t hover:bg-gray-50">
                    <td class="px-6 py-4">₹{item.sku}</td>
                    <td class="px-6 py-4">₹{item.name}</td>
                    <td class="px-6 py-4">₹{item.quantity}</td>
                    <td class="px-6 py-4">$₹{item.buyPrice.toFixed(2)}</td>
                    <td class="px-6 py-4">$₹{item.sellPrice.toFixed(2)}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 ₹{item.status === 'In Stock' ? 'bg-green-100 text-green-800' : item.status === 'Low Stock' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'} rounded-full text-sm">
                            ₹{item.status}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <button class="text-blue-600 hover:text-blue-800 mr-2" onclick="editItem('₹{item.sku}')">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-800" onclick="deleteItem('₹{item.sku}')">
                            <i class="bi bi-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function updateLowStockTable() {
            const table = document.getElementById('lowStockTable');
            const lowStockItems = inventory.filter(item => item.quantity <= 5).slice(0, 5);
            
            table.innerHTML = lowStockItems.length > 0 ? 
                lowStockItems.map(item => `
                    <tr class="border-t">
                        <td class="px-4 py-2">₹{item.sku}</td>
                        <td class="px-4 py-2">₹{item.name}</td>
                        <td class="px-4 py-2 ₹{item.quantity <= 2 ? 'text-red-600 font-semibold' : ''}">₹{item.quantity}</td>
                    </tr>
                `).join('') :
                '<tr><td colspan="3" class="px-4 py-2 text-center text-gray-500">No low stock items</td></tr>';
        }

        function updateTopSellingTable() {
            const table = document.getElementById('topSellingTable');
            
            // Calculate top selling items from transactions
            const salesByItem = {};
            transactions.filter(t => t.type === 'sale').forEach(sale => {
                if (!salesByItem[sale.sku]) {
                    salesByItem[sale.sku] = {
                        sku: sale.sku,
                        name: sale.item,
                        quantity: 0
                    };
                }
                salesByItem[sale.sku].quantity += sale.quantity;
            });
            
            const topSellingItems = Object.values(salesByItem)
                .sort((a, b) => b.quantity - a.quantity)
                .slice(0, 5);
            
            table.innerHTML = topSellingItems.length > 0 ?
                topSellingItems.map(item => `
                    <tr class="border-t">
                        <td class="px-4 py-2">₹{item.sku}</td>
                        <td class="px-4 py-2">₹{item.name}</td>
                        <td class="px-4 py-2 font-semibold">₹{item.quantity}</td>
                    </tr>
                `).join('') :
                '<tr><td colspan="3" class="px-4 py-2 text-center text-gray-500">No sales data available</td></tr>';
        }

        function updateTransactionsTable(type = 'all') {
            const table = document.getElementById('transactionsTable');
            const filteredTransactions = type === 'all' ? 
                transactions : 
                transactions.filter(t => t.type === type);
            
            table.innerHTML = filteredTransactions.map(t => `
                <tr class="border-t hover:bg-gray-50">
                    <td class="px-6 py-4">#₹{t.id.toString().padStart(3, '0')}</td>
                    <td class="px-6 py-4">₹{formatDate(t.date)}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 ₹{t.type === 'purchase' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'} rounded-full text-sm">
                            ₹{t.type === 'purchase' ? 'Purchase' : 'Sale'}
                        </span>
                    </td>
                    <td class="px-6 py-4">₹{t.sku}</td>
                    <td class="px-6 py-4">₹{t.item}</td>
                    <td class="px-6 py-4">₹{t.quantity}</td>
                    <td class="px-6 py-4">$₹{t.rate.toFixed(2)}</td>
                    <td class="px-6 py-4 font-semibold">$₹{t.total.toFixed(2)}</td>
                </tr>
            `).join('');
        }

        function updateSkuPerformanceTable() {
            const table = document.getElementById('skuPerformanceTable');
            
            // Calculate SKU performance from transactions
            const skuPerformance = {};
            
            inventory.forEach(item => {
                skuPerformance[item.sku] = {
                    sku: item.sku,
                    name: item.name,
                    inStock: item.quantity,
                    sold: 0,
                    profit: 0
                };
            });
            
            transactions.forEach(t => {
                if (t.type === 'sale') {
                    if (!skuPerformance[t.sku]) {
                        skuPerformance[t.sku] = {
                            sku: t.sku,
                            name: t.item,
                            inStock: 0,
                            sold: 0,
                            profit: 0
                        };
                    }
                    
                    const item = inventory.find(i => i.sku === t.sku);
                    
                    skuPerformance[t.sku].sold += t.quantity;
                    if (item) {
                        const profit = (t.rate - item.buyPrice) * t.quantity;
                        skuPerformance[t.sku].profit += profit;
                    }
                }
            });
            
            const performanceData = Object.values(skuPerformance)
                .sort((a, b) => b.profit - a.profit);
            
            table.innerHTML = performanceData.map(item => `
                <tr class="border-t">
                    <td class="px-4 py-2">₹{item.sku}</td>
                    <td class="px-4 py-2">₹{item.name}</td>
                    <td class="px-4 py-2">₹{item.inStock}</td>
                    <td class="px-4 py-2">₹{item.sold}</td>
                    <td class="px-4 py-2 font-semibold ₹{item.profit > 0 ? 'text-green-600' : 'text-red-600'}">
                        $₹{item.profit.toFixed(2)}
                    </td>
                </tr>
            `).join('');
        }

        // Transaction Filter
        document.querySelectorAll('.transaction-filter').forEach(button => {
            button.addEventListener('click', () => {
                // Update active button
                document.querySelectorAll('.transaction-filter').forEach(btn => {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                });
                button.classList.remove('bg-gray-200', 'text-gray-700');
                button.classList.add('bg-blue-600', 'text-white');
                
                // Filter transactions
                updateTransactionsTable(button.dataset.type);
            });
        });

        // Add Item Modal
        const addItemModal = document.getElementById('addItemModal');
        const addItemBtn = document.getElementById('addItemBtn');
        const closeAddItemModal = document.getElementById('closeAddItemModal');
        const addItemForm = document.getElementById('addItemForm');

        addItemBtn.addEventListener('click', () => {
            addItemModal.classList.remove('hidden');
            document.getElementById('itemSku').focus();
        });

        closeAddItemModal.addEventListener('click', () => {
            addItemModal.classList.add('hidden');
            addItemForm.reset();
        });

        addItemForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const newItem = {
                sku: document.getElementById('itemSku').value,
                name: document.getElementById('itemName').value,
                quantity: parseInt(document.getElementById('itemQuantity').value),
                buyPrice: parseFloat(document.getElementById('itemBuyPrice').value),
                sellPrice: parseFloat(document.getElementById('itemSellPrice').value),
                status: document.getElementById('itemStatus').value
            };
            
            // Check if SKU already exists
            const existingItem = inventory.find(item => item.sku === newItem.sku);
            if (existingItem) {
                alert('An item with this SKU already exists.');
                return;
            }
            
            inventory.push(newItem);
            addItemModal.classList.add('hidden');
            addItemForm.reset();
            
            // Update all tables and data
            updateInventoryTable();
            updateLowStockTable();
            updatePopulateSelects();
            
            alert('Item added successfully!');
        });

        // Transaction Modal
        const transactionModal = document.getElementById('transactionModal');
        const newPurchaseBtn = document.getElementById('newPurchaseBtn');
        const newSaleBtn = document.getElementById('newSaleBtn');
        const closeTransactionModal = document.getElementById('closeTransactionModal');
        const transactionForm = document.getElementById('transactionForm');
        const transactionType = document.getElementById('transactionType');
        const transactionSku = document.getElementById('transactionSku');
        const itemDetailsContainer = document.getElementById('itemDetailsContainer');
        const itemDetails = document.getElementById('itemDetails');
        const transactionQty = document.getElementById('transactionQty');
        const transactionRate = document.getElementById('transactionRate');
        const transactionTotal = document.getElementById('transactionTotal');
        const transactionSubmitBtn = document.getElementById('transactionSubmitBtn');
        
        newPurchaseBtn.addEventListener('click', () => {
            transactionType.value = 'purchase';
            transactionModalTitle.textContent = 'New Purchase';
            transactionSubmitBtn.textContent = 'Add Purchase';
            transactionSubmitBtn.className = 'bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700';
            
            // Set today's date
            document.getElementById('transactionDate').valueAsDate = new Date();
            
            transactionModal.classList.remove('hidden');
            populateSkuSelect();
        });
        
        newSaleBtn.addEventListener('click', () => {
            transactionType.value = 'sale';
            transactionModalTitle.textContent = 'New Sale';
            transactionSubmitBtn.textContent = 'Add Sale';
            transactionSubmitBtn.className = 'bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700';
            
            // Set today's date
            document.getElementById('transactionDate').valueAsDate = new Date();
            
            transactionModal.classList.remove('hidden');
            populateSkuSelect();
        });
        
        closeTransactionModal.addEventListener('click', () => {
            transactionModal.classList.add('hidden');
            transactionForm.reset();
            itemDetailsContainer.classList.add('hidden');
        });
        
        function populateSkuSelect() {
            // Clear previous options
            transactionSku.innerHTML = '<option value="">Select Item</option>';
            
            // Add inventory items
            inventory.forEach(item => {
                const option = document.createElement('option');
                option.value = item.sku;
                option.textContent = `₹{item.sku} - ₹{item.name}`;
                transactionSku.appendChild(option);
            });
        }
        
        transactionSku.addEventListener('change', () => {
            const selectedSku = transactionSku.value;
            if (selectedSku) {
                const item = inventory.find(i => i.sku === selectedSku);
                if (item) {
                    itemDetails.innerHTML = `
                        <p><span class="font-semibold">Item:</span> ₹{item.name}</p>
                        <p><span class="font-semibold">Current Stock:</span> ₹{item.quantity}</p>
                        <p><span class="font-semibold">₹{transactionType.value === 'purchase' ? 'Buy' : 'Sell'} Price:</span> $₹{(transactionType.value === 'purchase' ? item.buyPrice : item.sellPrice).toFixed(2)}</p>
                    `;
                    itemDetailsContainer.classList.remove('hidden');
                    
                    // Set default rate based on transaction type
                    transactionRate.value = transactionType.value === 'purchase' ? item.buyPrice : item.sellPrice;
                    
                    // For sales, limit max quantity
                    if (transactionType.value === 'sale') {
                        transactionQty.max = item.quantity;
                        if (item.quantity === 0) {
                            alert('This item is out of stock!');
                            transactionQty.disabled = true;
                        } else {
                            transactionQty.disabled = false;
                        }
                    } else {
                        transactionQty.max = '';
                        transactionQty.disabled = false;
                    }
                }
            } else {
                itemDetailsContainer.classList.add('hidden');
            }
        });
        
        // Calculate total when quantity or rate changes
        function calculateTotal() {
            const qty = parseInt(transactionQty.value) || 0;
            const rate = parseFloat(transactionRate.value) || 0;
            const total = qty * rate;
            transactionTotal.textContent = `$₹{total.toFixed(2)}`;
        }
        
        transactionQty.addEventListener('input', calculateTotal);
        transactionRate.addEventListener('input', calculateTotal);
        
        transactionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const sku = transactionSku.value;
            const item = inventory.find(i => i.sku === sku);
            
            if (!item) {
                alert('Please select a valid item.');
                return;
            }
            
            const quantity = parseInt(transactionQty.value);
            const rate = parseFloat(transactionRate.value);
            const date = document.getElementById('transactionDate').value;
            const type = transactionType.value;
            
            // Validate for sales
            if (type === 'sale' && quantity > item.quantity) {
                alert('Not enough stock available for this sale.');
                return;
            }
            
            // Create new transaction
            const newTransaction = {
                id: transactions.length + 1,
                date,
                type,
                sku,
                item: item.name,
                quantity,
                rate,
                total: quantity * rate
            };
            
            transactions.push(newTransaction);
            
            // Update inventory quantity
            if (type === 'purchase') {
                item.quantity += quantity;
                if (item.quantity > 5) {
                    item.status = 'In Stock';
                } else if (item.quantity > 0) {
                    item.status = 'Low Stock';
                }
            } else {
                item.quantity -= quantity;
                if (item.quantity === 0) {
                    item.status = 'Out of Stock';
                } else if (item.quantity <= 5) {
                    item.status = 'Low Stock';
                }
            }
            
            // Close modal and update data
            transactionModal.classList.add('hidden');
            transactionForm.reset();
            
            updateInventoryTable();
            updateTransactionsTable();
            updateLowStockTable();
            updateTopSellingTable();
            updateSkuPerformanceTable();
            
            alert('Transaction added successfully!');
        });

        function editItem(sku) {
            const item = inventory.find(i => i.sku === sku);
            if (!item) return;
            
            // Populate form
            document.getElementById('itemSku').value = item.sku;
            document.getElementById('itemSku').disabled = true; // Don't allow SKU change
            document.getElementById('itemName').value = item.name;
            document.getElementById('itemQuantity').value = item.quantity;
            document.getElementById('itemBuyPrice').value = item.buyPrice;
            document.getElementById('itemSellPrice').value = item.sellPrice;
            document.getElementById('itemStatus').value = item.status;
            
            // Open modal
            addItemModal.classList.remove('hidden');
            
            // Update form submission for editing
            const originalSubmit = addItemForm.onsubmit;
            addItemForm.onsubmit = function(e) {
                e.preventDefault();
                
                // Update item
                item.name = document.getElementById('itemName').value;
                item.quantity = parseInt(document.getElementById('itemQuantity').value);
                item.buyPrice = parseFloat(document.getElementById('itemBuyPrice').value);
                item.sellPrice = parseFloat(document.getElementById('itemSellPrice').value);
                item.status = document.getElementById('itemStatus').value;
                
                // Reset form and close modal
                document.getElementById('itemSku').disabled = false;
                addItemForm.reset();
                addItemModal.classList.add('hidden');
                
                // Update tables
                updateInventoryTable();
                updateLowStockTable();
                
                // Restore original submit handler
                addItemForm.onsubmit = originalSubmit;
                
                alert('Item updated successfully!');
            };
        }

        function deleteItem(sku) {
            if (confirm('Are you sure you want to delete this item?')) {
                const itemIndex = inventory.findIndex(i => i.sku === sku);
                if (itemIndex !== -1) {
                    inventory.splice(itemIndex, 1);
                    updateInventoryTable();
                    updateLowStockTable();
                    updatePopulateSelects();
                    alert('Item deleted successfully!');
                }
            }
        }

        function updatePopulateSelects() {
            populateSkuSelect();
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        }

        // Initialize the application
        showSection('dashboard');
        updateInventoryTable();
        updateTransactionsTable();
        updateLowStockTable();
        updateTopSellingTable();
        updateSkuPerformanceTable();
        
        // Set today's date for transaction forms
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('transactionDate').value = today;
    </script>
<script>document.body.addEventListener('wheel', e => { if (!e.ctrlKey) return; e.preventDefault(); return }, { passive: false })</script>
	</body>
</html>